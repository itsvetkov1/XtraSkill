# Milestone v1.9: UX Improvements

**Status:** SHIPPED 2026-02-02
**Phases:** 23-27
**Total Plans:** 9

## Overview

Reduce friction in daily chat workflow with standard chat UX patterns, improved project layout prioritizing conversations, and flexible chat organization that doesn't require project selection upfront.

## Phases

### Phase 23: chat-input-ux

**Goal:** Standard chat input behavior with Enter to send and expanded input area.
**Depends on:** None (standalone frontend change)
**Plans:** 1 plan

Plans:
- [x] 23-01-PLAN.md - Enter/Shift+Enter keyboard handling and expanded input

**Details:**
- FocusNode.onKeyEvent for keyboard handling (modern Flutter API)
- Enter sends message when non-empty, Shift+Enter inserts newline
- TextField maxLines: 10 with textInputAction: TextInputAction.none
- Widget tests for configuration verification

---

### Phase 24: project-layout-redesign

**Goal:** Threads become primary view with documents in collapsible side column.
**Depends on:** None (standalone frontend change)
**Plans:** 2 plans

Plans:
- [x] 24-01-PLAN.md - DocumentColumnProvider and DocumentsColumn widget foundation
- [x] 24-02-PLAN.md - Refactor ProjectDetailScreen to Row layout

**Details:**
- DocumentColumnProvider: Session-scoped ChangeNotifier (no persistence needed)
- DocumentsColumn: 48px collapsed strip, 280px expanded panel, AnimatedSize
- ProjectDetailScreen: Removed TabBar, replaced with Row layout
- Threads visible immediately on project open, documents in side column

---

### Phase 25: global-chats-backend

**Goal:** Backend support for project-less threads and global chats listing with frontend integration.
**Depends on:** None (backend foundation)
**Plans:** 2 plans

Plans:
- [x] 25-01-PLAN.md - Backend model changes and global thread API endpoints
- [x] 25-02-PLAN.md - Frontend Chats navigation and New Chat functionality

**Details:**
- Thread model: nullable project_id, user_id for direct ownership, last_activity_at
- Dual ownership validation: user_id for project-less, project.user_id for project threads
- GET /threads: paginated global thread listing with project_name
- POST /threads: create with optional project_id
- ChatsProvider, ChatsScreen, Chats navigation at index 1
- New Chat buttons on Home and Chats screens

---

### Phase 26: chat-project-association

**Goal:** Add project-less chats to projects with UI for association.
**Depends on:** Phase 25 (global chats must exist)
**Plans:** 2 plans

Plans:
- [x] 26-01-PLAN.md - Backend API extension for project_id in PATCH /threads
- [x] 26-02-PLAN.md - Frontend UI (toolbar button, menu, picker, confirmation)

**Details:**
- PATCH /threads/{id} extended to accept project_id
- Permanent one-way association (cannot be undone)
- Ownership transitions from user_id to project.user_id
- AddToProjectButton in conversation toolbar
- ProjectPickerDialog with confirmation flow
- Both toolbar button and options menu entry points

---

### Phase 27: thread-search-filter

**Goal:** Search and sort functionality for thread lists.
**Depends on:** None (standalone frontend feature)
**Plans:** 2 plans

Plans:
- [x] 27-01-PLAN.md - Core model + ChatsScreen search/sort UI
- [x] 27-02-PLAN.md - ThreadListScreen search/sort UI (mirror pattern)

**Details:**
- ThreadSortOption enum: newest, oldest, alphabetical
- filteredThreads computed getter in ChatsProvider and ThreadProvider
- Material 3 SearchBar with real-time filtering
- SegmentedButton for sort option selection
- Empty search state with clear button
- Widget tests for search/sort functionality

---

## Milestone Summary

**Key Decisions:**
- FocusNode.onKeyEvent for keyboard handling (not RawKeyboardListener)
- TextInputAction.none critical for custom Enter key handling
- Session-scoped column state (no persistence for "within session" requirement)
- Dual thread ownership model (user_id for project-less, project.user_id for project)
- SET NULL on project FK (threads become project-less on delete, not CASCADE)
- Permanent one-way association (simplifies data model)
- Client-side filtering with computed getters (sufficient for expected thread counts)

**Issues Resolved:**
- BUG-010: Empty FTS5 query crash
- BUG-011/012: Chats loading state issues
- BUG-013: GlobalThreadListResponse missing created_at field
- BUG-014: Project-scoped threads missing last_activity_at
- BUG-015: Shift+Enter not creating newline on web

**Issues Deferred:**
- Thread preview text (requires backend API changes)
- Thread mode indicator badges (requires backend tracking)

**Technical Debt Incurred:**
- Phase 26 missing formal VERIFICATION.md (verified via SUMMARY files)

---

*For current project status, see .planning/PROJECT.md*
*Archived: 2026-02-02*
