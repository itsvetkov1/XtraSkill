---
phase: 32-frontend-widget-model-tests
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/test/unit/models/message_test.dart
  - frontend/test/unit/models/project_test.dart
  - frontend/test/unit/models/document_test.dart
autonomous: true

must_haves:
  truths:
    - "Message model correctly serializes and deserializes from JSON"
    - "Project model handles nullable documents/threads correctly"
    - "Document model handles nullable content correctly"
  artifacts:
    - path: "frontend/test/unit/models/message_test.dart"
      provides: "Message and MessageRole serialization tests"
      min_lines: 60
    - path: "frontend/test/unit/models/project_test.dart"
      provides: "Project serialization tests"
      min_lines: 70
    - path: "frontend/test/unit/models/document_test.dart"
      provides: "Document serialization tests"
      min_lines: 50
  key_links:
    - from: "frontend/test/unit/models/message_test.dart"
      to: "frontend/lib/models/message.dart"
      via: "imports Message, MessageRole"
      pattern: "import.*models/message"
---

<objective>
Create JSON serialization round-trip tests for Message, Project, and Document models.

Purpose: Verify model serialization/deserialization works correctly for all field types, nullable fields, and edge cases - completing FMOD-01 requirement (part 1/2).

Output: Three test files covering all serialization scenarios for these core models.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/32-frontend-widget-model-tests/32-RESEARCH.md

# Source files
@frontend/lib/models/message.dart
@frontend/lib/models/project.dart
@frontend/lib/models/document.dart
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Message model tests</name>
  <files>frontend/test/unit/models/message_test.dart</files>
  <action>
Create test file at `frontend/test/unit/models/message_test.dart`:

1. Create directory if needed: `frontend/test/unit/models/`
2. Test MessageRole enum:
   - `fromJson` handles 'user' and 'assistant'
   - `fromJson` defaults to user for unknown role
   - `toJson` returns correct string

3. Test Message class:
   - `fromJson` with all required fields creates valid instance
   - `toJson` produces correct map
   - Round-trip: `fromJson(toJson(x))` preserves all fields
   - DateTime parsing uses ISO 8601 format

Test structure:
```dart
import 'package:flutter_test/flutter_test.dart';
import 'package:frontend/models/message.dart';

void main() {
  group('MessageRole', () {
    group('fromJson', () {
      test('parses user role');
      test('parses assistant role');
      test('defaults to user for unknown role');
    });
    group('toJson', () {
      test('returns name for user');
      test('returns name for assistant');
    });
  });

  group('Message', () {
    group('fromJson', () {
      test('creates valid instance from complete JSON');
    });
    group('toJson', () {
      test('produces valid map');
    });
    group('round-trip', () {
      test('preserves all fields');
    });
  });
}
```
  </action>
  <verify>Run `flutter test frontend/test/unit/models/message_test.dart -v` - all tests pass</verify>
  <done>8-10 tests covering MessageRole enum and Message class serialization</done>
</task>

<task type="auto">
  <name>Task 2: Create Project model tests</name>
  <files>frontend/test/unit/models/project_test.dart</files>
  <action>
Create test file at `frontend/test/unit/models/project_test.dart`:

1. Test fromJson:
   - Complete JSON with all fields
   - Minimal JSON (only required fields)
   - JSON with null description (valid)
   - JSON with null documents/threads (valid)
   - JSON with nested documents array
   - JSON with nested threads array

2. Test toJson:
   - Produces valid map
   - Excludes null description (not serialized if null)
   - Includes documents when present
   - Includes threads when present

3. Test round-trip:
   - Full object preserves all fields
   - Object with nulls preserves structure

Test structure:
```dart
import 'package:flutter_test/flutter_test.dart';
import 'package:frontend/models/project.dart';

void main() {
  group('Project', () {
    group('fromJson', () {
      test('creates instance from complete JSON');
      test('handles null description');
      test('handles null documents');
      test('handles null threads');
      test('parses nested documents array');
      test('parses nested threads array');
    });
    group('toJson', () {
      test('produces valid map');
      test('includes documents when present');
      test('includes threads when present');
    });
    group('round-trip', () {
      test('preserves all fields');
      test('preserves null optional fields');
    });
  });
}
```
  </action>
  <verify>Run `flutter test frontend/test/unit/models/project_test.dart -v` - all tests pass</verify>
  <done>10-12 tests covering Project serialization including nullable fields</done>
</task>

<task type="auto">
  <name>Task 3: Create Document model tests</name>
  <files>frontend/test/unit/models/document_test.dart</files>
  <action>
Create test file at `frontend/test/unit/models/document_test.dart`:

1. Test fromJson:
   - Complete JSON with all fields
   - Minimal JSON (without content)
   - JSON with null content

2. Test toJson:
   - Produces valid map
   - Excludes content when null
   - Includes content when present

3. Test round-trip:
   - Full object preserves all fields
   - Object without content preserves structure

Test structure:
```dart
import 'package:flutter_test/flutter_test.dart';
import 'package:frontend/models/document.dart';

void main() {
  group('Document', () {
    group('fromJson', () {
      test('creates instance from complete JSON');
      test('creates instance without content');
      test('handles null content');
    });
    group('toJson', () {
      test('produces valid map');
      test('excludes content when null');
      test('includes content when present');
    });
    group('round-trip', () {
      test('preserves all fields');
      test('preserves null content');
    });
  });
}
```
  </action>
  <verify>Run `flutter test frontend/test/unit/models/document_test.dart -v` - all tests pass</verify>
  <done>8-10 tests covering Document serialization including nullable content</done>
</task>

</tasks>

<verification>
Run all new model tests:
```bash
flutter test frontend/test/unit/models/ -v
```

Expected: All tests pass (26-32 tests for 3 models)
</verification>

<success_criteria>
1. Message model tests verify enum handling and all field serialization
2. Project model tests verify nullable documents/threads handling
3. Document model tests verify nullable content handling
4. All round-trip tests pass - fromJson(toJson(x)) preserves data
5. Tests run without errors: `flutter test frontend/test/unit/models/`
</success_criteria>

<output>
After completion, create `.planning/phases/32-frontend-widget-model-tests/32-01-SUMMARY.md`
</output>
