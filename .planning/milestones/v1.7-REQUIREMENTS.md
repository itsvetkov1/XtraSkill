# Archived Requirements: v1.7 URL & Deep Links

**Milestone:** v1.7
**Defined:** 2026-01-31
**Completed:** 2026-01-31
**Status:** All requirements implemented, ERR-04 awaiting manual validation

---

## v1.7 Requirements (All Complete)

### Route Architecture

- [x] **ROUTE-01**: Conversations have unique URLs (`/projects/:projectId/threads/:threadId`) - Phase 15
- [x] **ROUTE-02**: Browser back/forward navigation works correctly from conversation screen - Phase 17
- [x] **ROUTE-03**: GoRouter errorBuilder displays 404 page for invalid routes - Phase 15
- [x] **ROUTE-04**: ConversationScreen accepts projectId and threadId from URL parameters - Phase 17

### URL Preservation

- [x] **URL-01**: Page refresh preserves current URL for authenticated users - Phase 16
- [x] **URL-02**: URL preserved through OAuth redirect via session storage - Phase 16
- [x] **URL-03**: Settings page refresh returns to `/settings` (not `/home`) - Phase 16
- [x] **URL-04**: Project detail refresh returns to `/projects/:id` (not `/home`) - Phase 16

### Auth Flow

- [x] **AUTH-01**: Auth redirect captures intended destination as `returnUrl` query parameter - Phase 16
- [x] **AUTH-02**: Login completes to stored `returnUrl` instead of `/home` - Phase 16
- [x] **AUTH-03**: Direct login (no returnUrl) goes to `/home` - Phase 16
- [x] **AUTH-04**: `returnUrl` cleared from session storage after successful navigation - Phase 16

### Error Handling

- [x] **ERR-01**: Invalid route path shows 404 error page with navigation options - Phase 15
- [x] **ERR-02**: Valid route with non-existent project shows "Project not found" state - Phase 17
- [x] **ERR-03**: Valid route with non-existent thread shows "Thread not found" state - Phase 17
- [x] **ERR-04**: Invalid `returnUrl` (deleted resource) handled gracefully after login - Phase 18 *(implementation complete, manual validation pending in TESTING-QUEUE.md)*

---

## Requirement Outcomes

| Requirement | Status | Notes |
|-------------|--------|-------|
| ROUTE-01 | Validated | Nested routes working with breadcrumbs |
| ROUTE-02 | Validated | GoRouter.optionURLReflectsImperativeAPIs enabled |
| ROUTE-03 | Validated | NotFoundScreen with attempted path display |
| ROUTE-04 | Validated | URL params extracted and loaded |
| URL-01 | Validated | GoRouter handles authenticated refresh |
| URL-02 | Validated | UrlStorageService sessionStorage wrapper |
| URL-03 | Validated | Settings route preserved through refresh |
| URL-04 | Validated | Project detail route preserved |
| AUTH-01 | Validated | returnUrl query param in redirect |
| AUTH-02 | Validated | CallbackScreen navigates to stored URL |
| AUTH-03 | Validated | Default /home when no returnUrl |
| AUTH-04 | Validated | clearReturnUrl() called after navigation |
| ERR-01 | Validated | 404 page with "Go to Home" button |
| ERR-02 | Validated | ResourceNotFoundState for deleted project |
| ERR-03 | Validated | ResourceNotFoundState for deleted thread |
| ERR-04 | Awaiting | Manual test in TESTING-QUEUE.md |

---

## Deferred to v2.0

### Mobile Deep Links

- **MOBILE-01**: Android App Links configuration for native deep linking
- **MOBILE-02**: iOS Universal Links configuration for native deep linking
- **MOBILE-03**: Cold start deep link handling on both platforms

### Advanced URL Features

- **ADV-01**: Copy current URL button in AppBar
- **ADV-02**: Tab state in URL via query params (`?tab=threads`)
- **ADV-03**: Open Graph metadata for link previews

---

## Out of Scope

| Feature | Reason |
|---------|--------|
| Custom URL schemes (baassistant://) | Insecure, unprofessional - use platform deep links instead |
| Hash-based URLs | Already using path URL strategy correctly |
| Sensitive data in URLs | Security risk - use opaque IDs only (already implemented) |
| Smart redirect with scroll position | Complexity exceeds value for v1.7 |

---

## Coverage

- **v1.7 requirements:** 16 total
- **Implemented:** 16/16 (100%)
- **Validated:** 15/16 (93.75%)
- **Pending validation:** 1 (ERR-04 in TESTING-QUEUE.md)

---

*Archived: 2026-01-31*
